<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>临时邮箱验证码查看器</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <style>
    :root {
      --primary-color: #4f46e5;
      --primary-hover: #4338ca;
      --bg-color: #f3f4f6;
      --card-bg: #ffffff;
      --text-color: #1f2937;
      --border-radius: 12px;
      --dark-bg: #18181b;
      --dark-card: #23232a;
      --dark-text: #f3f4f6;
    }
    html[data-theme='dark'] {
      --bg-color: var(--dark-bg);
      --card-bg: var(--dark-card);
      --text-color: var(--dark-text);
    }
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:'Inter',sans-serif;background:var(--bg-color);min-height:100vh;padding:2rem;color:var(--text-color);transition:.3s}
    h1{font-size:2rem;font-weight:600;margin-bottom:2rem;text-align:center;display:flex;justify-content:center;gap:.5rem}
    .btn-group{display:flex;gap:1rem;justify-content:center;flex-wrap:wrap;margin-bottom:1.5rem}
    .btn{background:var(--primary-color);color:#fff;border:none;padding:1rem 2rem;font-size:1rem;font-weight:500;border-radius:var(--border-radius);cursor:pointer;transition:.3s}
    .btn:hover{background:var(--primary-hover);transform:translateY(-2px)}
    .btn.theme{background:#22223b}
    .btn.lang{background:#64748b}
    .tabs{display:flex;gap:.5rem;flex-wrap:wrap;margin-bottom:1rem;justify-content:center}
    .tab{background:#e0e7ff;color:#4f46e5;border:none;border-radius:8px 8px 0 0;padding:.5em 1.2em;cursor:pointer;font-size:1rem;margin-bottom:-1px;transition:.2s;border-bottom:2px solid transparent}
    .tab.active{background:var(--card-bg);color:var(--primary-color);border-bottom:2px solid var(--primary-color);font-weight:600}
    .card{background:var(--card-bg);padding:1.5rem;border-radius:var(--border-radius);box-shadow:0 4px 6px rgba(0,0,0,.1);margin-top:1.5rem;max-width:800px;margin-left:auto;margin-right:auto}
    .card-title{font-size:1.1rem;font-weight:600;margin-bottom:.75rem;display:flex;gap:.5rem;align-items:center}
    .content{font-size:1.1rem;color:#4b5563;word-break:break-all;line-height:1.5;display:flex;align-items:center;gap:.5rem}
    .copy{margin-left:10px;padding:.2em .8em;font-size:.95em;border:none;border-radius:6px;background:#e0e7ff;color:#4f46e5;cursor:pointer}
    .timer{font-size:.98rem;color:#e11d48;margin-left:.5rem}
    .history{margin-top:.5rem;padding-left:1.2rem;color:#64748b;font-size:.98rem;list-style:disc;max-height:120px;overflow-y:auto}
    .footer{margin-top:2rem;color:#6b7280;font-size:.95rem;text-align:center}
    .tip{margin-top:1.5rem;background:#fef9c3;color:#eab308;padding:.7em 1em;border-radius:8px;display:flex;gap:.5em;align-items:center;max-width:800px;margin-left:auto;margin-right:auto}
    @media(max-width:700px){body{padding:1rem}h1{font-size:1.6rem}.card{padding:1rem}}
  </style>
</head>
<body>
  <h1><i class="fa-solid fa-envelope-circle-check"></i><span id="title">临时邮箱验证码查看器</span></h1>
  <div class="btn-group">
    <button class="btn" id="newMailBtn"><i class="fa-solid fa-plus"></i><span id="newMailText"> 获取新邮箱</span></button>
    <button class="btn theme" id="themeBtn"><i class="fa-solid fa-moon"></i><span id="themeText"> 深色模式</span></button>
    <button class="btn lang" id="langBtn"><i class="fa-solid fa-language"></i><span id="langText"> English</span></button>
  </div>
  <div class="tabs" id="mailTabs"></div>
  <div class="card">
    <div class="card-title"><i class="fa-solid fa-envelope"></i><span id="emailTitle">当前邮箱</span></div>
    <div class="content"><span id="emailText">尚未获取</span><button class="copy" onclick="copy('emailText')">复制</button><span class="timer" id="timer"></span></div>
  </div>
  <div class="card">
    <div class="card-title"><i class="fa-solid fa-key"></i><span id="codeTitle">最新验证码</span></div>
    <div class="content"><span id="codeText">等待中...</span><button class="copy" onclick="copy('codeText')">复制</button></div>
    <ul class="history" id="history"></ul>
  </div>
  <div class="footer">作者TG：<a href="https://t.me/ios151" target="_blank">@ios151</a></div>
  <div class="tip"><i class="fa-solid fa-triangle-exclamation"></i><span id="tipText">请勿将临时邮箱用于重要账号注册，验证码可能被他人获取。</span></div>

<script>
const i18n = {
  zh:{title:'临时邮箱验证码查看器',newMail:'获取新邮箱',copy:'复制',copied:'已复制',email:'当前邮箱',code:'最新验证码',waiting:'等待中...',timer:'有效期',tip:'请勿将临时邮箱用于重要账号注册，验证码可能被他人获取。',dark:'深色模式',light:'浅色模式',english:'English',chinese:'中文',history:'验证码历史'},
  en:{title:'Temp Mail Code Viewer',newMail:'New Mailbox',copy:'Copy',copied:'Copied',email:'Current Email',code:'Latest Code',waiting:'Waiting...',timer:'Expires in',tip:'Do not use temp mail for important accounts. Codes may be public.',dark:'Dark Mode',light:'Light Mode',english:'English',chinese:'中文',history:'Code History'}
};
let lang='zh',theme='light';
let list=[],idx=-1, poll=null, tick=null;
function $(id){return document.getElementById(id)}
function setLang(l){lang=l;$('title').innerText=i18n[l].title;$('newMailText').textContent=' '+i18n[l].newMail;$('emailTitle').textContent=i18n[l].email;$('codeTitle').textContent=i18n[l].code;$('codeText').textContent=i18n[l].waiting;$('tipText').textContent=i18n[l].tip;$('themeText').textContent=' '+(theme==='dark'?i18n[l].light:i18n[l].dark);$('langText').textContent=' '+(lang==='zh'?i18n[l].english:i18n[l].chinese);renderHistory()}
$('langBtn').onclick=()=>setLang(lang==='zh'?'en':'zh');
$('themeBtn').onclick=()=>{theme=theme==='light'?'dark':'light';document.documentElement.dataset.theme=theme;$('themeText').textContent=' '+(theme==='dark'?i18n[lang].light:i18n[lang].dark)};
$('newMailBtn').onclick=addMail;
function uuid(){return'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,c=>{const r=Math.random()*16|0,v=c==='x'?r:(r&0x3|0x8);return v.toString(16)})}
async function addMail(){const cid=uuid();const create=await fetch('https://api.evapmail.com/v1/accounts/create',{method:'POST',headers:{'content-type':'application/json','em-client-id':cid,'em-client-type':'web','em-client-version':'1.3.2'},body:JSON.stringify({expirationMinutes:60})});const {email,token,expiresAt}=await create.json();const obj={email,token,cid,expiresAt,intros:[],history:[]};list.push(obj);idx=list.length-1;renderTabs();switchMail(idx)}
function renderTabs(){const t=$('mailTabs');t.innerHTML='';list.forEach((m,i)=>{const b=document.createElement('button');b.className='tab'+(i===idx?' active':'');b.textContent=m.email;b.onclick=()=>switchMail(i);t.appendChild(b)})}
function switchMail(i){if(poll)clearInterval(poll);if(tick)clearInterval(tick);idx=i;renderTabs();updateInfo();poll=setInterval(fetchUpdates,4000);tick=setInterval(updateTimer,1000);fetchUpdates();updateTimer()}
function updateInfo(){const m=list[idx];if(!m)return;$('emailText').textContent=m.email;$('codeText').textContent=m.intros[0]?extract(m.intros[0])||m.intros[0]:i18n[lang].waiting;renderHistory()}
function renderHistory(){const ul=$('history');ul.innerHTML='';const m=list[idx];if(!m)return;m.history.forEach(c=>{const li=document.createElement('li');li.textContent=extract(c)||c;ul.appendChild(li)})}
function copy(id){navigator.clipboard.writeText($(id).textContent);const btn=document.activeElement;const old=btn.textContent;btn.textContent=i18n[lang].copied;setTimeout(()=>btn.textContent=old,1200)}
function extract(t){const m=t.match(/\d{6}/);return m?m[0]:null}
async function fetchUpdates(){const m=list[idx];if(!m)return;const res=await fetch('https://api.evapmail.com/v1/messages/inbox',{headers:{'authorization':'Bearer '+m.token,'em-client-id':m.cid,'em-client-type':'web','em-client-version':'1.3.2'}});const msgs=await res.json();if(msgs.length){if(m.history.indexOf(msgs[0].intro)<0){m.history.unshift(msgs[0].intro);if(m.history.length>10)m.history.length=10}m.intros=msgs.map(x=>x.intro);updateInfo()}}
function updateTimer(){const m=list[idx];if(!m)return;let left=Math.floor((new Date(m.expiresAt).getTime()-Date.now())/1000);if(left<0)left=0;const min=Math.floor(left/60),sec=left%60;$('timer').textContent='('+i18n[lang].timer+': '+min+':'+'0'.repeat(sec<10)+sec+')'}
setLang('zh');
</script>
</body>
</html> 
